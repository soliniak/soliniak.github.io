"use strict";

const Projects = {
  yoga: {
    name: "yoga",
    live: "https://soliniak.github.io/examples/yoga/index.html",
    src: "https://github.com/soliniak/Yoga",
    img: "img/project_icons/yoga.jpg",
    webp: "img/project_icons/yoga.webp",
    alt: "WWW - WebDev Challenge #16",
    order: "10",
    stack: {
      html5: ["true", '<i class="fab fa-html5 icon--stack"></i>'],
      js: ["true", '<i class="fab fa-js icon--stack"></i>'],
      gulp: ["true", '<i class="fab fa-gulp icon--stack"></i>'],
      photoshop: ["true", '<i class="ps-icon icon--stack"></i>'],
      npm: ["true", '<i class="fab fa-npm icon--stack"></i>'],
      sass: ["true", '<i class="fab fa-sass icon--stack"></i>'],
      react: ["false", '<i class="fab fa-react icon--stack"></i>']
    }
  },
  zest: {
    name: "zest",
    live: "https://soliniak.github.io/examples/zest/",
    src: "https://github.com/soliniak/ZEST",
    img: "img/project_icons/zest.jpg",
    webp: "img/project_icons/zest.webp",
    alt: "WWW - WebDev Challenge #12",
    order: "20",
    stack: {
      html5: ["true", '<i class="fab fa-html5 icon--stack"></i>'],
      js: ["true", '<i class="fab fa-js icon--stack"></i>'],
      gulp: ["true", '<i class="fab fa-gulp icon--stack"></i>'],
      photoshop: ["true", '<i class="ps-icon icon--stack"></i>'],
      npm: ["true", '<i class="fab fa-npm icon--stack"></i>'],
      sass: ["true", '<i class="fab fa-sass icon--stack"></i>'],
      react: ["false", '<i class="fab fa-react icon--stack"></i>']
    }
  },
  mogo: {
    name: "mogo",
    live: "https://soliniak.github.io/examples/mogo/",
    src: "https://github.com/soliniak/mogo",
    img: "img/project_icons/mogo.jpg",
    webp: "img/project_icons/mogo.webp",
    alt: "WWW - WebDev Challenge #35",
    order: "30",
    stack: {
      html5: ["true", '<i class="fab fa-html5 icon--stack"></i>'],
      js: ["true", '<i class="fab fa-js icon--stack"></i>'],
      gulp: ["true", '<i class="fab fa-gulp icon--stack"></i>'],
      photoshop: ["true", '<i class="ps-icon icon--stack"></i>'],
      npm: ["true", '<i class="fab fa-npm icon--stack"></i>'],
      sass: ["true", '<i class="fab fa-sass icon--stack"></i>'],
      react: ["false", '<i class="fab fa-react icon--stack"></i>']
    }
  },
  lorem: {
    name: "lorem",
    live: "https://soliniak.github.io/examples/landingpage/",
    src: "https://github.com/soliniak/zapakujloremipsum",
    img: "img/project_icons/zapakujlorem.jpg",
    webp: "img/project_icons/zapakujlorem.webp",
    alt: "WWW - Landing Page",
    order: "40",
    stack: {
      html5: ["true", '<i class="fab fa-html5 icon--stack"></i>'],
      js: ["true", '<i class="fab fa-js icon--stack"></i>'],
      gulp: ["true", '<i class="fab fa-gulp icon--stack"></i>'],
      photoshop: ["false", '<i class="ps-icon icon--stack"></i>'],
      npm: ["true", '<i class="fab fa-npm icon--stack"></i>'],
      sass: ["true", '<i class="fab fa-sass icon--stack"></i>'],
      react: ["false", '<i class="fab fa-react icon--stack"></i>']
    }
  },
  typer: {
    name: "typer",
    live: "https://soliniak.github.io/examples/typer/",
    src: "https://github.com/soliniak/Word-typing-counter",
    img: "img/project_icons/typer.jpg",
    webp: "img/project_icons/typer.webp",
    alt: "APP - word typing counter",
    order: "25",
    stack: {
      html5: ["true", '<i class="fab fa-html5 icon--stack"></i>'],
      js: ["true", '<i class="fab fa-js icon--stack"></i>'],
      gulp: ["true", '<i class="fab fa-gulp icon--stack"></i>'],
      photoshop: ["false", '<i class="ps-icon icon--stack"></i>'],
      npm: ["true", '<i class="fab fa-npm icon--stack"></i>'],
      sass: ["true", '<i class="fab fa-sass icon--stack"></i>'],
      react: ["false", '<i class="fab fa-react icon--stack"></i>']
    }
  },
  weatherApp: {
    name: "weather",
    live: "https://soliniak.github.io/Weather-App/",
    src: "https://github.com/soliniak/Weather-App",
    img: "img/project_icons/weather-app.jpg",
    webp: "img/project_icons/weather-app.webp",
    alt: "APP - REST API Weather App",
    order: "1",
    stack: {
      html5: ["true", '<i class="fab fa-html5 icon--stack"></i>'],
      js: ["true", '<i class="fab fa-js icon--stack"></i>'],
      gulp: ["true", '<i class="fab fa-gulp icon--stack"></i>'],
      photoshop: ["true", '<i class="ps-icon icon--stack"></i>'],
      npm: ["true", '<i class="fab fa-npm icon--stack"></i>'],
      sass: ["true", '<i class="fab fa-sass icon--stack"></i>'],
      react: ["true", '<i class="fab fa-react icon--stack"></i>']
    }
  },
  tictactoe: {
    name: "TicTacToe",
    live: "https://s.codepen.io/Rafi-R/debug/NjOwGV/YvAgOnRKbPYA",
    src: "https://codepen.io/Rafi-R/pen/NjOwGV",
    img: "img/project_icons/tictactoe.jpg",
    webp: "img/project_icons/tictactoe.webp",
    alt: "Game - simple and funny",
    order: "50",
    stack: {
      html5: ["true", '<i class="fab fa-html5 icon--stack"></i>'],
      js: ["true", '<i class="fab fa-js icon--stack"></i>'],
      gulp: ["false", '<i class="fab fa-gulp icon--stack"></i>'],
      photoshop: ["false", '<i class="ps-icon icon--stack"></i>'],
      npm: ["false", '<i class="fab fa-npm icon--stack"></i>'],
      sass: ["true", '<i class="fab fa-sass icon--stack"></i>'],
      react: ["false", '<i class="fab fa-react icon--stack"></i>']
    }
  }
};

// get data from projects and put it in article mockup
Object.entries(Projects).forEach(([project, projectValue]) => {
  let stackData = "";
  if (typeof projectValue.stack != "undefined") {
    Object.entries(projectValue.stack).forEach(([stack, stackValue]) => {
      if (stackValue[0] == "true") {
        stackData += stackValue[1];
        return stackData;
      }
    });
  }

  let articleMockup = `
  <div class="card__description">
    <div class="card__header">
        <h2 class="card__title">${projectValue.name}</h2>
        <span>
          <a href="${
            projectValue.live
          }" class="btn--square btn--live"> live </a>
          <a href="${projectValue.src}" class="btn--square"> src </a>
        </span>
    </div>
    <p class="card__text">
      ${projectValue.alt}
    </p>
    <div class="card__stack">
    
      ${stackData}
    </div>
  </div>
  <picture class="image__container portfolio-image__container">
    <source type="image/webp" srcset="${
      projectValue.webp
    }" class="card__image portfolio-image" />
    <img src="${projectValue.img}" alt="${
    projectValue.alt
  }" class="card__image portfolio-image" />
  </picture>`;

  let article = document.createElement("article");
  article.classList.add("card", "portfolio__card");
  article.style.order = projectValue.order;
  article.innerHTML = articleMockup;
  portfolio.appendChild(article);
});

const cards = document.querySelectorAll(".card");

[].forEach.call(cards, card => {
  card.addEventListener("mousedown", () => {
    card.style.backgroundColor = "#fbfbfb";
  });
  card.addEventListener("mouseup", () => {
    card.style.backgroundColor = "#fff";
  });
});

// --- active section
const btnContact = document.querySelector(".btn--contact"),
  menuLink = document.querySelectorAll(".menu__link"),
  linkMobile = document.querySelectorAll("[data-mobile=false]"),
  btnGotoContact = document.querySelector(".btn--goto-contact"),
  aboutSection = -100,
  portfolioSection = 0,
  contactSection = 100;

btnGotoContact.addEventListener("click", () => {
  showActiveSectionHideRest(contactSection);
  adjustWindowHeightTo(contact);
  btnContact.classList.add("link--active");
  window.innerHeight = "400px";
});
// navigate thgrough sections and set aria-hidden
menu.addEventListener("click", function(e) {
  if (e.target) {
    let offset;
    const sectionTarget = e.target.getAttribute("href");
    const section = document.querySelector(sectionTarget);

    if (sectionTarget == "#about") offset = -100;
    if (sectionTarget == "#portfolio") offset = 0;
    if (sectionTarget == "#contact") offset = 100;

    if (
      sectionTarget == "#about" ||
      sectionTarget == "#portfolio" ||
      sectionTarget == "#contact"
    ) {
      e.preventDefault();

      adjustWindowHeightTo(section);
      // scrollbarVisible(section);
    }
    showActiveSectionHideRest(offset);
    section.setAttribute("aria-hidden", "false");

    e.target.classList.add("link--active");
  }
});

const adjustWindowHeightTo = section => {
  const thisSection = section.offsetHeight;
  html.style.height = thisSection + 50 + "px";
  body.style.height = thisSection + 50 + "px";
  // scrollbarVisible(portfolio);
};

const setAriaHiddenToButtons = () => {
  if (body.offsetWidth > 1024) {
    [].forEach.call(linkMobile, item => {
      item.setAttribute("aria-hidden", "false");
    });
  } else {
    [].forEach.call(linkMobile, item => {
      item.setAttribute("aria-hidden", "true");
    });
  }
};

function windowHeightAndAriaHidden() {
  setAriaHiddenToButtons();
  adjustWindowHeightTo(portfolio);
}

window.addEventListener("load", windowHeightAndAriaHidden());
window.addEventListener("resize", windowHeightAndAriaHidden());

let showActiveSectionHideRest = offset => {
  about.style.left = aboutSection - offset + "vw";
  about.setAttribute("aria-hidden", "true");

  portfolio.style.left = portfolioSection - offset + "vw";
  portfolio.setAttribute("aria-hidden", "true");

  contact.style.left = contactSection - offset + "vw";
  contact.setAttribute("aria-hidden", "true");

  [].forEach.call(menuLink, link => {
    link.classList.remove("link--active");
  });
};

// check if scrollbar is visible
let scrollbarVisible = section => {
  if (
    document.documentElement.clientHeight < html.offsetHeight &&
    body.offsetWidth > 768
  ) {
    section.style.paddingRight = "3rem";
  }
};
